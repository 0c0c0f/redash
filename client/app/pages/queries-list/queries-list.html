<div class="container">
  <page-header title="Queries"></page-header>

  <empty-state icon="fa fa-code" description="Getting the data from your datasources." help-link="http://help.redash.io/category/21-querying"
    ng-if="$ctrl.showEmptyState()"></empty-state>

  <div class="row" ng-if="$ctrl.showList()">
    <div class="col-lg-3">
      <input type='text' class='form-control' placeholder="Search Queries..."
             ng-change="$ctrl.update()" ng-model="$ctrl.searchText" autofocus/>
      <div class='list-group m-t-10 m-b-10 tags-list tiled'>
        <a href="queries" class="list-group-item"
          ng-class="{active: $ctrl.currentPage == 'all'}">
          All Queries
        </a>
        <a href="queries/favorite" class="list-group-item"
          ng-class="{active: $ctrl.currentPage == 'favorites'}">
          <span class="btn-favourite">
            <i class="fa fa-star" aria-hidden="true"></i>
          </span>
          Favorites
        </a>
        <a href="queries/my" class="list-group-item"
          ng-class="{active: $ctrl.currentPage == 'my'}">
          <img ng-src="{{$ctrl.currentUser.profile_image_url}}" class="profile__image--navbar"
            width="13" style="margin-right: 0;"/>
          My Queries
        </a>

        <a ng-repeat='tag in $ctrl.allTags' ng-class='{"active": $ctrl.tagIsSelected(tag)}'
           class='list-group-item' ng-click='$ctrl.toggleTag($event, tag)'>
          {{ tag }}
        </a>
      </div>
    </div>

    <div class="col-lg-9 p-l-0">

      <div class="bg-white tiled">
        <table class="table table-condensed table-hover table-data">
          <thead>
            <tr>
              <th></th>
              <th>Name</th>
              <th></th>
              <th>Created At</th>
              <th>Runtime</th>
              <th>Last Executed At</th>
              <th>Update Schedule</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="query in $ctrl.paginator.getPageRows()">
              <td class="p-r-0"><favorites-control item="query"></favorites-control></td>
              <td class="table-main-title">
                <a href="queries/{{query.id}}">{{query.name}}</a>
                <br>
                <span class="label label-default" ng-if="query.is_draft">Unpublished</span>
                <span class="label label-tag">#sales</span><span class="label label-tag">#2018</span><span class="label label-tag">#ops</span>
              </td>
              <td class="p-r-0">
                <img ng-src="{{query.user.profile_image_url}}" class="profile__image_thumb" title="Created by {{query.user.name}}"/>
              </td>
              <td>{{query.created_at | dateTime}}</td>
              <td>{{query.runtime | durationHumanize}}</td>
              <td>{{query.retrieved_at | dateTime}}</td>
              <td>{{query.schedule | scheduleHumanize}}</td>
            </tr>
          </tbody>
        </table>
        <paginator paginator="$ctrl.paginator"></paginator>
      </div>
    </div>
  </div>
</div>
